<!DOCTYPE html>
<html lang="hi">

<head>
  <meta charset="UTF-8" />
  <title>
    <%= pageTitle %>
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#f97316',
            soft: '#fff7ed',
            whitepure: '#ffffff',
            other: '#64748b'
          },
          boxShadow: {
            soft: '0 20px 45px rgba(0,0,0,0.08)',
            glow: '0 20px 40px rgba(249,115,22,0.35)'
          }
        }
      }
    }
  </script>
</head>

<body class="bg-gradient-to-br from-orange-50 via-whitepure to-orange-100 min-h-screen text-gray-800">

  <%- include('partials/header') %>

    <main class="max-w-6xl mx-auto px-4 py-20">

      <% if (!isLoggedIn) { %>

        <div class="bg-whitepure rounded-[3rem] shadow-soft p-16 text-center">
          <h2 class="text-3xl font-extrabold text-primary mb-4">
            рдЖрдк рд▓реЙрдЧрд┐рди рдирд╣реАрдВ рд╣реИрдВ
          </h2>
          <p class="text-other mb-10">
            рдкреНрд░реЛрдлрд╛рдЗрд▓ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд▓реЙрдЧрд┐рди рдХрд░реЗрдВ
          </p>
          <a href="/login" class="inline-block bg-primary text-white px-14 py-4 rounded-2xl font-bold shadow-glow">
            рд▓реЙрдЧрд┐рди рдХрд░реЗрдВ
          </a>
        </div>

        <% } else { %>

          <% let maskedAadhar='рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' ; if (user.Aadhar_cardNumber) { maskedAadhar='XXXX XXXX ' +
            user.Aadhar_cardNumber.slice(-4); } %>

            <!-- ================= PROFILE HEADER ================= -->
            <div class="relative bg-whitepure rounded-[3.5rem] shadow-soft p-14 mb-20 overflow-hidden">
              <div class="absolute -top-24 -right-24 w-72 h-72 bg-orange-200 rounded-full blur-3xl opacity-30"></div>

              <div class="relative flex flex-col md:flex-row gap-14 items-center">

                <<<<<<< HEAD=======<!-- Avatar -->
                  >>>>>>> d7ddbf226c630c4ccc6f336cf0a09156aea4e60b
                  <div class="w-36 h-36 rounded-full bg-primary text-white flex items-center justify-center
                text-6xl font-extrabold shadow-glow">
                    <%= user.Name.charAt(0).toUpperCase() %>
                  </div>

                  <<<<<<< HEAD=======<!-- User Info -->
                    >>>>>>> d7ddbf226c630c4ccc6f336cf0a09156aea4e60b
                    <div class="flex-1 text-center md:text-left">
                      <h2 class="text-4xl font-extrabold mb-2">
                        <%= user.Name %>
                      </h2>

                      <span class="inline-block px-6 py-2 rounded-full text-xs font-bold mb-8
        <%= role === 'employer'
          ? 'bg-orange-100 text-primary'
          : 'bg-slate-100 text-slate-700' %>">
                        <%= role==='employer' ? 'ЁЯПв рдХрд╛рдо рджреЗрдиреЗ рд╡рд╛рд▓рд╛' : 'ЁЯС╖ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛' %>
                      </span>

                      <div class="grid sm:grid-cols-2 gap-6 max-w-xl mx-auto md:mx-0">
                        <div class="bg-soft rounded-2xl p-6 border border-orange-100">
                          <p class="text-xs text-other mb-1">ЁЯУ▒ рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░</p>
                          <p class="font-bold text-lg">
                            <%= user.Mobile %>
                          </p>
                        </div>

                        <div class="bg-soft rounded-2xl p-6 border border-orange-100">
                          <p class="text-xs text-other mb-1">ЁЯЖФ рдЖрдзрд╛рд░ рдХрд╛рд░реНрдб</p>
                          <p class="font-bold tracking-widest">
                            <%= maskedAadhar %>
                          </p>
                        </div>
                      </div>
                    </div>

              </div>
            </div>

            <!-- ================= WORKER VIEW ================= -->
            <% if (role==='worker' ) { %>

              <% if (acceptedJobs.length> 0) { %>
                <div class="mb-14 bg-green-50 p-10 rounded-3xl border border-green-200">
                  <h3 class="text-2xl font-extrabold text-green-700 mb-6">
                    тЬФ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЧрдП рдХрд╛рдо
                  </h3>

                  <% acceptedJobs.forEach(job=> { %>
                    <div class="bg-whitepure rounded-2xl p-6 mb-4 border border-green-100">

                      <h4 class="text-xl font-bold mb-1">
                        <%= job.title %>
                      </h4>
                      <p class="text-sm text-other mb-3">ЁЯУН <%= job.location %>
                      </p>

                      <div class="grid sm:grid-cols-2 gap-4 text-sm mb-4">
                        <p><strong>ЁЯХТ рд╕рдордп:</strong>
                          <%= job.jobTime %>
                        </p>
                        <p><strong>ЁЯТ░ рд╡реЗрддрди:</strong>
                          <%= job.salary || 'рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ' %>
                        </p>
                        <p class="sm:col-span-2"><strong>ЁЯУЭ рд╡рд┐рд╡рд░рдг:</strong>
                          <%= job.description || 'рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' %>
                        </p>
                        <p class="sm:col-span-2"><strong>ЁЯУЮ рд╕рдВрдкрд░реНрдХ:</strong>
                          <%= job.contact %>
                        </p>
                      </div>

                      <p class="text-green-700 font-semibold text-sm">
                        рдХрд╛рдо рджреЗрдиреЗ рд╡рд╛рд▓рд╛: <%= job.employer?.Name || 'рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' %>
                      </p>

                    </div>
                    <% }) %>
                </div>
                <% } %>

                  <% if (rejectedJobs.length> 0) { %>
                    <div class="mb-14 bg-orange-50 p-10 rounded-3xl border border-orange-200">
                      <h3 class="text-2xl font-extrabold text-orange-600 mb-6">
                        тЭМ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЧрдП рдХрд╛рдо
                      </h3>

                      <% rejectedJobs.forEach(job=> { %>
                        <div class="bg-whitepure rounded-2xl p-6 mb-4 border border-orange-100">

                          <h4 class="text-xl font-bold mb-1">
                            <%= job.title %>
                          </h4>
                          <p class="text-sm text-other mb-3">ЁЯУН <%= job.location %>
                          </p>

                          <div class="grid sm:grid-cols-2 gap-4 text-sm mb-4">
                            <p><strong>ЁЯХТ рд╕рдордп:</strong>
                              <%= job.jobTime %>
                            </p>
                            <p><strong>ЁЯТ░ рд╡реЗрддрди:</strong>
                              <%= job.salary || 'рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ' %>
                            </p>
                            <p class="sm:col-span-2"><strong>ЁЯУЭ рд╡рд┐рд╡рд░рдг:</strong>
                              <%= job.description || 'рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' %>
                            </p>
                            <p class="sm:col-span-2"><strong>ЁЯУЮ рд╕рдВрдкрд░реНрдХ:</strong>
                              <%= job.contact %>
                            </p>
                          </div>

                          <p class="text-red-600 font-semibold text-sm">
                            рдпрд╣ рдХрд╛рдо рдЖрдкрдХреЛ рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛
                          </p>

                          <p class="text-xs text-gray-500 mt-1">
                            рдХрд╛рдо рджреЗрдиреЗ рд╡рд╛рд▓рд╛: <%= job.employer?.Name || 'рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' %>
                          </p>

                        </div>
                        <% }) %>
                    </div>
                    <% } %>

                      <% } %>

                        <!-- ================= EMPLOYER VIEW ================= -->
                        <% if (role==='employer' ) { %>

                          <h3 class="text-2xl font-extrabold mb-8">
                            ЁЯУЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдбрд╛рд▓реЗ рдЧрдП рдХрд╛рдо
                          </h3>

                          <% postedJobs.forEach(job=> { %>

                            <div class="bg-whitepure rounded-3xl p-10 mb-12 border border-orange-100">

                              <h4 class="text-2xl font-extrabold mb-2">
                                <%= job.title %>
                              </h4>
                              <p class="text-sm text-other mb-4">ЁЯУН <%= job.location %>
                              </p>

                              <div class="grid sm:grid-cols-2 gap-6 text-sm mb-6">
                                <p><strong>ЁЯХТ рдХрд╛рдо рдХрд╛ рд╕рдордп:</strong>
                                  <%= job.jobTime %>
                                </p>
                                <p><strong>ЁЯТ░ рд╡реЗрддрди:</strong>
                                  <%= job.salary || 'рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ' %>
                                </p>
                                <p class="sm:col-span-2"><strong>ЁЯУЭ рд╡рд┐рд╡рд░рдг:</strong>
                                  <%= job.description || 'рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ' %>
                                </p>
                                <p class="sm:col-span-2"><strong>ЁЯУЮ рд╕рдВрдкрд░реНрдХ:</strong>
                                  <%= job.contact %>
                                </p>
                              </div>

                              <p class="font-semibold text-primary mb-4">
                                ЁЯСе рдЖрд╡реЗрджрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ: <%= job.applicants.length %>
                              </p>

                              <% if (job.applicants.length> 0) { %>
                                <% job.applicants.forEach(applicant=> { %>

                                  <% const isAccepted=job.acceptedApplicants .map(a=> a.toString())
                                    .includes(applicant._id.toString());

                                    const isRejected = job.rejectedApplicants
                                    .map(a => a.toString())
                                    .includes(applicant._id.toString());
                                    %>

                                    <<<<<<< HEAD <!-- ЁЯФз ONLY FIXED CLASSES BELOW -->
                                      <div class="flex flex-col sm:flex-row
                sm:justify-between sm:items-center
                gap-4
                bg-soft p-5 rounded-2xl mb-3 border">
                                        =======
                                        <div
                                          class="flex justify-between items-center bg-soft p-5 rounded-2xl mb-3 border">
                                          >>>>>>> d7ddbf226c630c4ccc6f336cf0a09156aea4e60b

                                          <div>
                                            <p class="font-bold">ЁЯС╖ <%= applicant.Name %>
                                            </p>
                                            <p class="text-sm">ЁЯУ▒ <%= applicant.Mobile %>
                                            </p>

                                            <% if (isAccepted) { %>
                                              <p class="text-green-600 text-sm font-semibold">тЬФ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛</p>
                                              <% } else if (isRejected) { %>
                                                <p class="text-red-600 text-sm font-semibold">тЭМ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛</p>
                                                <% } else { %>
                                                  <p class="text-orange-600 text-sm font-semibold">тП│ рдирд┐рд░реНрдгрдп рд▓рдВрдмрд┐рдд</p>
                                                  <% } %>
                                          </div>


                                          <div class="flex flex-wrap gap-2">
                                            <div class="flex gap-2">

                                              <% if (!isAccepted && !isRejected) { %>
                                                <form method="POST"
                                                  action="/jobs/<%= job._id %>/applicants/<%= applicant._id %>/accept">
                                                  <button class="bg-green-600 text-white px-4 py-2 rounded-xl">тЬФ
                                                    рд╕реНрд╡реАрдХрд╛рд░</button>
                                                </form>

                                                <form method="POST"
                                                  action="/jobs/<%= job._id %>/applicants/<%= applicant._id %>/reject">
                                                  <button class="bg-orange-500 text-white px-4 py-2 rounded-xl">тЭМ
                                                    рдЕрд╕реНрд╡реАрдХрд╛рд░</button>
                                                </form>
                                                <% } %>

                                                  <form method="POST"
                                                    action="/jobs/<%= job._id %>/applicants/<%= applicant._id %>/remove">
                                                    <button class="bg-red-600 text-white px-4 py-2 rounded-xl">ЁЯЧС
                                                      рд╣рдЯрд╛рдПрдВ</button>
                                                  </form>
                                            </div>

                                          </div>

                                          <% }) %>
                                            <% } else { %>
                                              <p class="text-sm text-gray-500">рдЕрднреА рдХреЛрдИ рдЖрд╡реЗрджрди рдирд╣реАрдВ рдЖрдпрд╛ рд╣реИред</p>
                                              <% } %>

                                        </div>

                                        <% }) %>
                                          <% } %>

                                            <% } %>

    </main>
</body>

</html>